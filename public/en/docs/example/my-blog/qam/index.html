<!DOCTYPE html>
<html lang="en" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Introduction
  #

This project is based on the major coursework of ENG3014 Communications Systems 3 at the University of Glasgow.
The task is to use what we have learned in the course to implement a simple communication system simulation:

This should include at minimum:

A message of your choice, comprising more than 2048 bits, converted from a ‚ÄúSTRING‚Äù to a ‚ÄúBINARY‚Äù.
Using your modulation format of choice, modulate a carrier to encode this information.
The channel SNR to be considered will be 6dB, 18dB and 24dB with respect to AGWN.
An output filter limiting the transmitter bandwidth to less than 20% of the carrier frequency.
Demodulation of the signal and recovery of the signal. Please analyse the Bit Error Rate of the received signal over multiple retransmission of the signal over the simulated channel.
Discuss in your report choices you make, such as modulation format, Baud Rate, Filter type and bandwidth.

Up to 30% of the marks allocated will be included for creative additions (10% each), these could include:">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/en/docs/example/my-blog/qam/">
  <meta property="og:site_name" content="ZCHENG LI">
  <meta property="og:title" content="Dynamic QAM Modulation & Demodulation in Python">
  <meta property="og:description" content="Introduction # This project is based on the major coursework of ENG3014 Communications Systems 3 at the University of Glasgow.
The task is to use what we have learned in the course to implement a simple communication system simulation:
This should include at minimum:
A message of your choice, comprising more than 2048 bits, converted from a ‚ÄúSTRING‚Äù to a ‚ÄúBINARY‚Äù. Using your modulation format of choice, modulate a carrier to encode this information. The channel SNR to be considered will be 6dB, 18dB and 24dB with respect to AGWN. An output filter limiting the transmitter bandwidth to less than 20% of the carrier frequency. Demodulation of the signal and recovery of the signal. Please analyse the Bit Error Rate of the received signal over multiple retransmission of the signal over the simulated channel. Discuss in your report choices you make, such as modulation format, Baud Rate, Filter type and bandwidth. Up to 30% of the marks allocated will be included for creative additions (10% each), these could include:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Dynamic QAM Modulation &amp; Demodulation in Python | ZCHENG LI</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/en/docs/example/my-blog/qam/">
  <link rel="alternate" hreflang="zh-cn" href="http://localhost:1313/docs/example/my-blog/qam/" title="Âä®ÊÄÅQAMË∞ÉÂà∂Ëß£Ë∞ÉpythonÂÆûÁé∞">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.aad5a8f283f8e9eab0a8a8af2e009772f992bcfb3a898f9ecbdedd224640f133.js" integrity="sha256-qtWo8oP46eqwqKivLgCXcvmSvPs6iY&#43;ey97dIkZA8TM=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/en/"><span>ZCHENG LI</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  



  
    
  


  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/docs/example/my-blog/qam/">
          ÁÆÄ‰Ωì‰∏≠Êñá
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <span>My Blogs</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/docs/example/my-blog/qam/" class="active">Dynamic QAM Modulation &amp; Demodulation in Python</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-316eed7585ddf2826093144a1ab46376" class="toggle"  />
    <label for="section-316eed7585ddf2826093144a1ab46376" class="flex justify-between">
      <a role="button" class="">RN Planning and Scheduling</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/en/docs/example/my-blog/pns/pns_ch1/" class="">CH1. Planning and Scheduling: Roles and Impact</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/docs/example/my-blog/pns/pns_ch2/" class="">CH2. Manufacturing Models</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/docs/example/my-blog/pns/pns_ch4/" class="">CH4. Project Planning and Scheduling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/en/docs/example/my-blog/pns/pns_ch5/" class="">CH5.Machien and JSS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6c70eadb0aa09b0724af1b0ec9953205" class="toggle"  />
    <label for="section-6c70eadb0aa09b0724af1b0ec9953205" class="flex justify-between">
      <a role="button" class="">Navigation</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Dynamic QAM Modulation &amp; Demodulation in Python</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#libraries">Libraries</a></li>
    <li><a href="#converting-between-string-and-binary">Converting Between String and Binary</a></li>
    <li><a href="#awgn-noise">AWGN Noise</a></li>
    <li><a href="#qam-modulation">QAM Modulation</a>
      <ul>
        <li><a href="#qam-theory">QAM Theory</a></li>
        <li><a href="#qam-code-implementation">QAM Code Implementation</a></li>
        <li><a href="#qam-constellation-diagram">QAM Constellation Diagram</a></li>
      </ul>
    </li>
    <li><a href="#path-loss-simulation-hata-model">Path Loss Simulation: Hata Model</a></li>
    <li><a href="#qam-demodulation">QAM Demodulation</a></li>
    <li><a href="#bit-error-rate-ber">Bit Error Rate (BER)</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="introduction">
  Introduction
  <a class="anchor" href="#introduction">#</a>
</h2>
<p>This project is based on the major coursework of <strong>ENG3014 Communications Systems 3</strong> at the University of Glasgow.<br>
The task is to use what we have learned in the course to implement a simple communication system simulation:</p>
<!-- raw HTML omitted -->
<p>This should include at minimum:</p>
<ul>
<li>A message of your choice, comprising more than 2048 bits, converted from a ‚ÄúSTRING‚Äù to a ‚ÄúBINARY‚Äù.</li>
<li>Using your modulation format of choice, modulate a carrier to encode this information.</li>
<li>The channel SNR to be considered will be 6dB, 18dB and 24dB with respect to AGWN.</li>
<li>An output filter limiting the transmitter bandwidth to less than 20% of the carrier frequency.</li>
<li>Demodulation of the signal and recovery of the signal. Please analyse the Bit Error Rate of the received signal over multiple retransmission of the signal over the simulated channel.</li>
<li>Discuss in your report choices you make, such as modulation format, Baud Rate, Filter type and bandwidth.</li>
</ul>
<p>Up to 30% of the marks allocated will be included for creative additions (10% each), these could include:</p>
<ul>
<li>Simulate fading conditions associated with an urban environment. Implementation of Hamming coding or other error correction technique.</li>
<li>Transmission of video, audio or other time varying signal over the channel.</li>
<li>Dynamic modulation, based on measured system performance.</li>
<li>Automatic resending of errored signals.</li>
<li>Or anything else you think would be a cool addition!</li>
</ul>
<!-- raw HTML omitted -->
<p>:-(</p>
<p>In short, the task can be summarised as follows:</p>
<ol>
<li>Convert a string input into a binary sequence consisting of 0s and 1s.</li>
<li>Encode it using Hamming code.</li>
<li>Add noise.</li>
<li>Modulate the signal using a modulation scheme of your choice.</li>
<li>Demodulate it at the receiver.</li>
<li>Compute the bit error rate (BER) and other performance metrics.</li>
</ol>
<p>My project follows the pipeline shown below:</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_flow.png"><figure>
          <img src="/img/QAM/QAM_flow.png" alt="QAM Flowchart" title="Figure 1: Implementation flowchart"/>
          <figcaption>Figure 1: Implementation flowchart</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>Don‚Äôt panic ‚Äî we‚Äôll go through everything step by step üëÄ.</p>
<hr>
<h2 id="libraries">
  Libraries
  <a class="anchor" href="#libraries">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> numpy <span style="color:#f92672">import</span> log2, arange, sqrt, flip, concatenate, zeros, array, floor, sqrt, array, bitwise_xor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> numpy.random <span style="color:#f92672">import</span> randint
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> ceil
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> signal 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hamming <span style="color:#f92672">import</span> encode, decode
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> bitarray <span style="color:#f92672">import</span> bitarray
</span></span></code></pre></div><p>‚∏ª</p>
<h2 id="converting-between-string-and-binary">
  Converting Between String and Binary
  <a class="anchor" href="#converting-between-string-and-binary">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">string2bits</span>(s<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>):
</span></span><span style="display:flex;"><span>    out <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join([bin(ord(x))[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> s])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [int(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> list(out)]
</span></span></code></pre></div><p>That‚Äôs a lot of strange-looking functions üò©, so let‚Äôs break them down.</p>
<ul>
<li><code>ord(x)</code>: returns the Unicode code point (int) of character x.</li>
</ul>
<p>For example: &lsquo;a&rsquo; ‚Üí 97, &lsquo;?&rsquo; ‚Üí 63.</p>
<ul>
<li><code>bin(ord(x))</code>: converts that decimal integer into a binary string (str).</li>
</ul>
<p>&lsquo;a&rsquo; ‚Üí 97 ‚Üí &ldquo;0b1100001&rdquo;
&lsquo;?&rsquo; ‚Üí 63 ‚Üí &ldquo;0b111111&rdquo;</p>
<p>Notice the &ldquo;0b&rdquo; prefix. We therefore need:</p>
<ul>
<li><code>bin(ord(x))[2:]</code>: to strip off &ldquo;0b&rdquo;.</li>
</ul>
<p>&lsquo;a&rsquo; ‚Üí &ldquo;1100001&rdquo;</p>
<p>&lsquo;?&rsquo; ‚Üí &ldquo;111111&rdquo;</p>
<p>However, the resulting bit strings do not have a fixed length, which would cause problems during decoding.</p>
<p>So we pad them to 8 bits:</p>
<ul>
<li><code>bin(ord(x))[2:].zfill(8)</code></li>
</ul>
<p>&lsquo;a&rsquo; ‚Üí &ldquo;01100001&rdquo;
&lsquo;?&rsquo; ‚Üí &ldquo;00111111&rdquo;</p>
<p>Next:</p>
<ul>
<li><code>''.join([bin(ord(x))[2:].zfill(8) for x in s])</code></li>
</ul>
<p>concatenates all 8-bit binary representations into one long string.</p>
<p>&lsquo;a?&rsquo; ‚Üí &ldquo;0110000100111111&rdquo;</p>
<p>Finally, integers are easier to work with than characters, so:</p>
<ul>
<li><code>return [int(x) for x in list(out)]</code></li>
</ul>
<p>&lsquo;a?&rsquo; ‚Üí [0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1]</p>
<p>Ta-da üéâ.</p>
<p>Since we now understand this messy conversion, let‚Äôs also look at how to convert it back
(Binary ‚Üí String):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bits2string</span>(b<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join([chr(int(x, <span style="color:#ae81ff">2</span>)) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> b])
</span></span></code></pre></div><p>The idea is very similar: iterate through each binary chunk, convert it back to decimal using int(x, 2), then use <code>chr()</code> to recover the character, and finally join everything into a string.</p>
<p>‚∏ª</p>
<h2 id="awgn-noise">
  AWGN Noise
  <a class="anchor" href="#awgn-noise">#</a>
</h2>
<p>Let‚Äôs skip Hamming coding for now and first look at how AWGN noise is added:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">awgn</span>(signal, snr, seed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&#39;&#39; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Additive White Gaussian Noise (AWGN) function.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> seed:
</span></span><span style="display:flex;"><span>        np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    sigpower <span style="color:#f92672">=</span> sum([math<span style="color:#f92672">.</span>pow(abs(signal[A_I]), <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> A_I <span style="color:#f92672">in</span> range(len(signal))])
</span></span><span style="display:flex;"><span>    sigpower <span style="color:#f92672">=</span> sigpower <span style="color:#f92672">/</span> len(signal)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    noisepower <span style="color:#f92672">=</span> sigpower <span style="color:#f92672">/</span> (math<span style="color:#f92672">.</span>pow(<span style="color:#ae81ff">10</span>, snr<span style="color:#f92672">/</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    noise <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(<span style="color:#ae81ff">0</span>, np<span style="color:#f92672">.</span>sqrt(noisepower), len(signal))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>array([noise])
</span></span></code></pre></div><p>Here,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sigpower <span style="color:#f92672">=</span> sum([math<span style="color:#f92672">.</span>pow(abs(signal[A_I]), <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> A_I <span style="color:#f92672">in</span> range(len(signal))])
</span></span><span style="display:flex;"><span>sigpower <span style="color:#f92672">=</span> sigpower <span style="color:#f92672">/</span> len(signal)
</span></span></code></pre></div><p>iterates through the signal and computes its average power.</p>
<p>Why do we need the signal power?
Because from the definition of SNR:</p>
<span>
  \[
\mathrm{SNR}{\text{dB}} = 10 \log{10} \left( \frac{P_{\text{signal}}}{P_{\text{noise}}} \right)
\]
</span>

<p>Given the SNR, we can compute the required noise power:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>noisepower <span style="color:#f92672">=</span> sigpower <span style="color:#f92672">/</span> (math<span style="color:#f92672">.</span>pow(<span style="color:#ae81ff">10</span>, snr<span style="color:#f92672">/</span><span style="color:#ae81ff">10</span>))
</span></span></code></pre></div><p>We then generate Gaussian noise with that power and add it to the signal.</p>
<p>Example outputs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>SNR <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span> dB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array([[<span style="color:#f92672">-</span><span style="color:#ae81ff">0.03305892</span>,  <span style="color:#ae81ff">0.93648725</span>,  <span style="color:#ae81ff">1.07229167</span>,  <span style="color:#ae81ff">0.03032389</span>, <span style="color:#f92672">...</span>]])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SNR <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span> dB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array([[ <span style="color:#ae81ff">0.15621611</span>,  <span style="color:#ae81ff">0.5966272</span> ,  <span style="color:#ae81ff">0.40825385</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">0.03236429</span>, <span style="color:#f92672">...</span>]])
</span></span></code></pre></div><p>Clearly, higher SNR ‚Üí less noise; lower SNR ‚Üí a much messier signal.</p>
<p>‚∏ª</p>
<h2 id="qam-modulation">
  QAM Modulation
  <a class="anchor" href="#qam-modulation">#</a>
</h2>
<p>(Should we first talk about what QAM actually is?)</p>
<p>What is QAM?</p>
<p>According to Wikipedia:</p>
<!-- raw HTML omitted -->
<blockquote>
<p>Quadrature amplitude modulation (QAM) is the name of a family of digital modulation methods and a related family of analog modulation methods widely used in modern telecommunications to transmit information. It conveys two analog message signals, or two digital bit streams, by changing (modulating) the amplitudes of two carrier waves, using the amplitude-shift keying (ASK) digital modulation scheme or amplitude modulation (AM) analog modulation scheme. The two carrier waves are of the same frequency and are out of phase with each other by 90¬∞, a condition known as orthogonality or quadrature. The transmitted signal is created by adding the two carrier waves together. At the receiver, the two waves can be coherently separated (demodulated) because of their orthogonality.</p></blockquote>
<!-- raw HTML omitted -->
<p>(Yeah‚Ä¶ that‚Äôs long.)</p>
<p>In one sentence: QAM is more spectrally efficient.</p>
<p>For example, 16-QAM can transmit 4 bits per symbol, while AM can only transmit 1 bit per symbol.</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_capacity_compare.png"><figure>
          <img src="/img/QAM/QAM_capacity_compare.png" alt="ÂêÑÁßçË∞ÉÂà∂ÊñπÊ≥ïÈÄöÈÅìÂÆπÈáèÊØîËæÉ" title="Fig2: Comparision of different modulation methods"/>
          <figcaption>Fig2: Comparision of different modulation methods</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>In this implementation, QAM can be summarised in three steps:</p>
<ol>
<li>Split the input bitstream into two halves.</li>
<li>Apply amplitude shift keying (ASK).</li>
<li>Multiply each branch by its carrier.</li>
</ol>
<p>A schematic is shown below:</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_flow_mod.png"><figure>
          <img src="/img/QAM/QAM_flow_mod.png" alt="QAM Ë∞ÉÂà∂" title="Fig3: QAM mod flowchart"/>
          <figcaption>Fig3: QAM mod flowchart</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<h3 id="qam-theory">
  QAM Theory
  <a class="anchor" href="#qam-theory">#</a>
</h3>
<p>Why does QAM actually work for modulation and demodulation?<br>
Formulas make this much easier to see.</p>
<p>First, split the input into two equal halves, and compute the ASK amplitudes for each branch: <span>
  \( A_I(t) \)
</span>
 and <span>
  \( A_Q(t) \)
</span>
.</p>
<span>
  \[

I(t) = A_I(t) cos(2\pi f t) \\

Q(t) = A_Q(t) sin(2\pi f t)

\]
</span>

<p>Here, <span>
  \( f \)
</span>
 is the carrier frequency.<br>
Then we add <span>
  \( I(t) \)
</span>
 and <span>
  \( Q(t) \)
</span>
 together:</p>
<span>
  \[

I(t) + Q(t) = A_I(t) cos(2\pi f t) + A_Q(t) sin(2\pi f t)

\]
</span>

<p>During demodulation, we multiply the received signal by each carrier:</p>
<span>
  \[

(I(t) + Q(t)) cos(2\pi f t) = \frac{1}{2} (A_I(t) + A_I(t)cos(4\pi f t) + A_Q(t)sin(4\pi f t))

\]
</span>

<span>
  \[

(I(t) + Q(t)) sin(2\pi f t) = \frac{1}{2} (A_Q(t) + A_I(t)cos(4\pi f t) - A_Q(t)sin(4\pi f t)) 

\]
</span>

<p>After filtering out the high-frequency components:</p>
<span>
  \[

Filter((I(t) + Q(t)) cos(2\pi f t)) \approx \frac{1}{2} A_I(t)

\]
</span>

<span>
  \[

Filter((I(t) + Q(t)) sin(2\pi f t)) \approx \frac{1}{2} A_Q(t)

\]
</span>

<p>And that‚Äôs how we successfully recover <span>
  \( A_I(t) \)
</span>
 and <span>
  \( A_Q(t) \)
</span>
 üéâ.</p>
<h3 id="qam-code-implementation">
  QAM Code Implementation
  <a class="anchor" href="#qam-code-implementation">#</a>
</h3>
<p>To make the plots look nicer, let‚Äôs tweak the initial input string and SNR:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Signal-to-Noise Ratio (SNR) in dB for the simulation</span>
</span></span><span style="display:flex;"><span>snr <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Input string to be transmitted. </span>
</span></span><span style="display:flex;"><span>input_string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Communications Systems Communication Channel Simulation and Report. In this project, you will complete a simulation of a wireless communication system. This builds on the tasks in Lab 1 and the lectures cover all the background theory for each part of the task.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># input_string = &#34;a?&#34;</span>
</span></span></code></pre></div><p>To implement dynamic QAM, we want to choose different QAM orders (QAM4, QAM16, or QAM64) depending on SNR.
Here, for snr = 24, it would normally select QAM64 dynamically ‚Äî but for demonstration purposes, we manually force it to QAM16.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Dynamically adjust the modulation order based on the Signal-to-Noise Ratio (SNR)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> snr <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">28</span>: 
</span></span><span style="display:flex;"><span>    M <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>  <span style="color:#75715e"># Use 64-QAM for high SNR, allowing more symbols (6 bits per symbol) for higher data rates</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> snr <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span>: 
</span></span><span style="display:flex;"><span>    M <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>  <span style="color:#75715e"># Use 16-QAM for moderate SNR, balancing data rate and noise resilience</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>: 
</span></span><span style="display:flex;"><span>    M <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>  <span style="color:#75715e"># Use 4-QAM (QPSK) for low SNR, prioritizing robustness over data rate</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if you do NOT want to use dynamic modulation you can use the following instruction.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Default modulation order for QAM (16-QAM) indicating 16 different symbols</span>
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>M
</span></span></code></pre></div><p>Some derived values (mainly to make later calculations easier):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sqrt_M <span style="color:#f92672">=</span> int(sqrt(M))
</span></span><span style="display:flex;"><span>size_symbol <span style="color:#f92672">=</span> int(log2(M))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n_symbol <span style="color:#f92672">=</span> int(len(input_string) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">8</span> <span style="color:#f92672">/</span> size_symbol)) <span style="color:#75715e"># number of QAM symbols to create</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>size_symbol, n_symbol
</span></span></code></pre></div><p>For QAM16 with the given message, size_symbol = 4 and n_symbol = 522.
The first means each symbol can carry 4 bits ‚Äúin one go‚Äù; the second means this message needs 522 QAM symbols to transmit.</p>
<p>Next, we define two carriers:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Define carrier signal parameters</span>
</span></span><span style="display:flex;"><span>f_s <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span> <span style="color:#75715e"># Sampling frequency in MHz</span>
</span></span><span style="display:flex;"><span>rep_symbol <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span> <span style="color:#75715e"># Number of samples used to represent a single QAM symbol</span>
</span></span><span style="display:flex;"><span>max_t <span style="color:#f92672">=</span> rep_symbol <span style="color:#f92672">*</span> n_symbol <span style="color:#f92672">/</span> f_s <span style="color:#75715e"># Total time duration of the signal</span>
</span></span><span style="display:flex;"><span>print(max_t)
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, max_t, int(f_s <span style="color:#f92672">*</span> max_t)) <span style="color:#75715e"># Generate the time vector for the signal</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>f_c <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span> <span style="color:#75715e"># Carrier frequency in MHz</span>
</span></span><span style="display:flex;"><span>A_c <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># Amplitude of the carrier</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate the in-phase (I) and quadrature (Q) carrier signals</span>
</span></span><span style="display:flex;"><span>carrier_I <span style="color:#f92672">=</span> A_c<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>cos(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>pi<span style="color:#f92672">*</span>f_c<span style="color:#f92672">*</span>t)
</span></span><span style="display:flex;"><span>carrier_Q <span style="color:#f92672">=</span> A_c<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>sin(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>pi<span style="color:#f92672">*</span>f_c<span style="color:#f92672">*</span>t)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, carrier_I)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">26.3</span>
</span></span></code></pre></div><p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_carrier.png"><figure>
          <img src="/img/QAM/QAM_carrier.png" alt="QAM ËΩΩÊ≥¢" title="Fig4: QAM carrier wave"/>
          <figcaption>Fig4: QAM carrier wave</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>In the code, you‚Äôll see a variable called rep_symbol.</p>
<p>It‚Äôs used below to ‚Äúrepeat‚Äù each input symbol and expand it into a time sequence ‚Äî basically for better sampling and nicer plots.</p>
<p>And <code>f_s</code> is the sampling frequency used when plotting these waveforms.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Reshape the noisy input into blocks corresponding to QAM symbols</span>
</span></span><span style="display:flex;"><span>input_QAM <span style="color:#f92672">=</span> input_b_noise<span style="color:#f92672">.</span>reshape((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,size_symbol))
</span></span><span style="display:flex;"><span>print(input_QAM<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize arrays for amplitude components of in-phase (I) and quadrature (Q)</span>
</span></span><span style="display:flex;"><span>A_I <span style="color:#f92672">=</span> zeros((input_QAM<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>],))
</span></span><span style="display:flex;"><span>A_Q <span style="color:#f92672">=</span> zeros((input_QAM<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>],))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Amplitude modulation: Calculate the amplitudes for I and Q components</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(int(size_symbol <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)):
</span></span><span style="display:flex;"><span>    A_I <span style="color:#f92672">=</span> A_I <span style="color:#f92672">+</span> input_QAM[:,n] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> (int(size_symbol <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> n)
</span></span><span style="display:flex;"><span>    A_Q <span style="color:#f92672">=</span> A_Q <span style="color:#f92672">+</span> input_QAM[:,n <span style="color:#f92672">+</span> int(size_symbol <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">**</span> (int(size_symbol <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> n)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># QAM</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(A_I)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(A_Q)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate repeated in-phase amplitude signal to match the time resolution</span>
</span></span><span style="display:flex;"><span>s_I <span style="color:#f92672">=</span> A_I<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>repeat(rep_symbol, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Modulate the in-phase component with the cosine carrier</span>
</span></span><span style="display:flex;"><span>s_I_mod <span style="color:#f92672">=</span> s_I <span style="color:#f92672">*</span> carrier_I
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(s_I)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate repeated quadrature amplitude signal to match the time resolution</span>
</span></span><span style="display:flex;"><span>s_Q <span style="color:#f92672">=</span> A_Q<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>repeat(rep_symbol, <span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Modulate the quadrature component with the sine carrier</span>
</span></span><span style="display:flex;"><span>s_Q_mod <span style="color:#f92672">=</span> s_Q <span style="color:#f92672">*</span> carrier_Q
</span></span></code></pre></div><p>Now let‚Äôs plot the modulated signals:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_I_mod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_I, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#34;modulated I&#34;</span>, <span style="color:#e6db74">&#34;I&#34;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_Q_mod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_Q, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#34;modulated Q&#34;</span>, <span style="color:#e6db74">&#34;Q&#34;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s_mod <span style="color:#f92672">=</span> s_I_mod <span style="color:#f92672">+</span> s_Q_mod
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_mod, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.legend([&#34;modulated s&#34;, &#34;s&#34;])</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span></code></pre></div><p>Output:</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_I_mod.png"><figure>
          <img src="/img/QAM/QAM_I_mod.png" alt="QAM Ë∞ÉÂà∂ÂêéÁöÑ I ÂàÜÈáè‰ø°Âè∑" title="Fig5: QAM modulated I comp."/>
          <figcaption>Fig5: QAM modulated I comp.</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_Q_mod.png"><figure>
          <img src="/img/QAM/QAM_Q_mod.png" alt="QAM Ë∞ÉÂà∂ÂêéÁöÑ Q ÂàÜÈáè‰ø°Âè∑" title="Fig6: QAM modulated Q comp."/>
          <figcaption>Fig6: QAM modulated Q comp.</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_I&#43;Q_mod.png"><figure>
          <img src="/img/QAM/QAM_I&#43;Q_mod.png" alt="QAM Ë∞ÉÂà∂ÂêéÁöÑÊÄª‰ø°Âè∑" title="Fig7: QAM modulated signal in total"/>
          <figcaption>Fig7: QAM modulated signal in total</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<h3 id="qam-constellation-diagram">
  QAM Constellation Diagram
  <a class="anchor" href="#qam-constellation-diagram">#</a>
</h3>
<p>To plot the constellation, we use the following variables and function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Generate a normalized QAM constellation by representing points in binary format</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For example, QAM16: 00, 01, 10, 11</span>
</span></span><span style="display:flex;"><span>norm_constallation <span style="color:#f92672">=</span> [bin(x)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(size_symbol <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> arange(sqrt_M)]
</span></span><span style="display:flex;"><span>norm_constallation
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_constellation</span>(S, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        Plots the QAM constellation diagram, showing signal points and the grid of possible symbols.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Separate the real and imaginary parts of the symbols for plotting</span>
</span></span><span style="display:flex;"><span>        sx,sy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>real(S), np<span style="color:#f92672">.</span>imag(S)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Map to constellation coord</span>
</span></span><span style="display:flex;"><span>        k <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>(sqrt_M <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        sx <span style="color:#f92672">=</span> [k <span style="color:#f92672">*</span> x <span style="color:#f92672">+</span> b <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sx]
</span></span><span style="display:flex;"><span>        sy <span style="color:#f92672">=</span> [k <span style="color:#f92672">*</span> y <span style="color:#f92672">+</span> b <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> sy]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Plot the symbols as scatter points</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> label:
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>scatter(sx,sy,s<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, c<span style="color:#f92672">=</span>color, label<span style="color:#f92672">=</span>label)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>scatter(sx,sy,s<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, c<span style="color:#f92672">=</span>color)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Overlay the QAM grid points and annotate them with their binary representations</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i, x <span style="color:#f92672">in</span> enumerate(range(<span style="color:#f92672">-</span>sqrt_M <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, sqrt_M, <span style="color:#ae81ff">2</span>)):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j, y <span style="color:#f92672">in</span> enumerate(range(<span style="color:#f92672">-</span>sqrt_M <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>, sqrt_M, <span style="color:#ae81ff">2</span>)):
</span></span><span style="display:flex;"><span>                plt<span style="color:#f92672">.</span>scatter(x, y, s<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;r&#34;</span>)
</span></span><span style="display:flex;"><span>                plt<span style="color:#f92672">.</span>annotate(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>norm_constallation[i]<span style="color:#e6db74">}{</span>norm_constallation[j]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, xy<span style="color:#f92672">=</span>(x<span style="color:#f92672">-</span><span style="color:#ae81ff">0.25</span>, y<span style="color:#f92672">-</span><span style="color:#ae81ff">0.5</span>))
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        axis_limit <span style="color:#f92672">=</span> sqrt_M
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>axis([<span style="color:#f92672">-</span>axis_limit,axis_limit,<span style="color:#f92672">-</span>axis_limit,axis_limit])
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>axhline(<span style="color:#ae81ff">0</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>axvline(<span style="color:#ae81ff">0</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>grid(<span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># draw constellation</span>
</span></span><span style="display:flex;"><span>S <span style="color:#f92672">=</span> A_I <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>j <span style="color:#f92672">*</span> A_Q
</span></span><span style="display:flex;"><span>print(S[:<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plot_constellation(S)
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#ae81ff">1.88111148</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2.08807572</span>j <span style="color:#ae81ff">3.01975263</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.01366766</span>j <span style="color:#ae81ff">2.05328757</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1.12644641</span>j <span style="color:#ae81ff">1.83682459</span><span style="color:#f92672">+</span><span style="color:#ae81ff">3.0908774</span>j  <span style="color:#ae81ff">2.00044805</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2.97572787</span>j <span style="color:#ae81ff">2.9585253</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">0.84307519</span>j <span style="color:#ae81ff">1.92937708</span><span style="color:#f92672">+</span><span style="color:#ae81ff">3.06050133</span>j <span style="color:#ae81ff">1.07733372</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1.0006585</span>j  <span style="color:#ae81ff">2.98315354</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0.84013525</span>j <span style="color:#ae81ff">2.08884394</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1.86715759</span>j]
</span></span></code></pre></div><p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM16_cons_b.png"><figure>
          <img src="/img/QAM/QAM16_cons_b.png" alt="QAM16 ÊòüÂ∫ßÂõæ(ÂèëÈÄÅÂâç)" title="Fig8: QAM16 constellation (send)"/>
          <figcaption>Fig8: QAM16 constellation (send)</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<hr>
<h2 id="path-loss-simulation-hata-model">
  Path Loss Simulation: Hata Model
  <a class="anchor" href="#path-loss-simulation-hata-model">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Hata Model for small or medium-sized city.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#f_c: in MHz</span>
</span></span><span style="display:flex;"><span>h_b <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e"># height of BS antenna in metres</span>
</span></span><span style="display:flex;"><span>h_m <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># height of mobile antenna in matres</span>
</span></span><span style="display:flex;"><span>distance <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>]);  <span style="color:#75715e">#in km</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C_H <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span> <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1.1</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log10(f_c) <span style="color:#f92672">-</span> <span style="color:#ae81ff">0.7</span>) <span style="color:#f92672">*</span> h_m <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.56</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log10(f_c)
</span></span><span style="display:flex;"><span>L_U <span style="color:#f92672">=</span> <span style="color:#ae81ff">69.55</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">26.16</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log10(f_c) <span style="color:#f92672">-</span> <span style="color:#ae81ff">13.82</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>log10(h_b) <span style="color:#f92672">-</span> C_H <span style="color:#f92672">+</span> (<span style="color:#ae81ff">44.9</span><span style="color:#f92672">-</span><span style="color:#ae81ff">6.55</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>log10(h_b))<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>log10(distance)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(distance, L_U)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Distance from transmitter(in km)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Path loss (in dB)&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span></code></pre></div><p>output:</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/Hata_model.png"><figure>
          <img src="/img/QAM/Hata_model.png" alt="Hata model" title="Fig9: Hata model"/>
          <figcaption>Fig9: Hata model</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>As we can see, the farther the distance, the larger the path loss.</p>
<h2 id="qam-demodulation">
  QAM Demodulation
  <a class="anchor" href="#qam-demodulation">#</a>
</h2>
<p>To make demodulation easier, let‚Äôs first write a filter:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">butter_lowpass_filter</span>(data, cutoff, fs, order):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Applies a Butterworth lowpass filter to the given data. 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Calculate the Nyquist frequency (half the sampling frequency)</span>
</span></span><span style="display:flex;"><span>    nyq <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> fs
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Normalize the cutoff frequency to the Nyquist frequency</span>
</span></span><span style="display:flex;"><span>    normal_cutoff <span style="color:#f92672">=</span> cutoff <span style="color:#f92672">/</span> nyq
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># b, a are the filter coefficients</span>
</span></span><span style="display:flex;"><span>    b, a <span style="color:#f92672">=</span> signal<span style="color:#f92672">.</span>butter(order, normal_cutoff, btype<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;low&#39;</span>, analog<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Apply the filter to the data using forward-backward filtering</span>
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> signal<span style="color:#f92672">.</span>filtfilt(b, a, data)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> y
</span></span></code></pre></div><p>QAM demodulation and the corresponding waveforms:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Demodulate the in-phase (I) component</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Multiply the received signal by the in-phase carrier and scale by 2 to isolate the I component</span>
</span></span><span style="display:flex;"><span>s_I_demod <span style="color:#f92672">=</span> s_mod <span style="color:#f92672">*</span> carrier_I <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the Butterworth lowpass filter to remove high-frequency components</span>
</span></span><span style="display:flex;"><span>s_I_demod <span style="color:#f92672">=</span> butter_lowpass_filter(s_I_demod, <span style="color:#ae81ff">50</span>, f_s, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Demodulate the quadrature (Q) component</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Multiply the received signal by the quadrature carrier and scale by 2 to isolate the Q component</span>
</span></span><span style="display:flex;"><span>s_Q_demod <span style="color:#f92672">=</span> s_mod <span style="color:#f92672">*</span> carrier_Q <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Apply the Butterworth lowpass filter to remove high-frequency components</span>
</span></span><span style="display:flex;"><span>s_Q_demod <span style="color:#f92672">=</span> butter_lowpass_filter(s_Q_demod, <span style="color:#ae81ff">50</span>, f_s, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the modulated and demodulated in-phase components</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_I_mod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_I_demod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#34;modulated I&#34;</span>, <span style="color:#e6db74">&#34;demodulated I&#34;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the modulated and demodulated quadrature components</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_Q_mod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(t, s_Q_demod)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(left<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, right<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#34;modulated Q&#34;</span>, <span style="color:#e6db74">&#34;demodulated Q&#34;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>grid()
</span></span></code></pre></div><p>output:</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_I_demod.png"><figure>
          <img src="/img/QAM/QAM_I_demod.png" alt="QAM Ëß£Ë∞ÉÂêéÁöÑ I ÂàÜÈáè‰ø°Âè∑" title="Fig10: QAM demod. I comp"/>
          <figcaption>Fig10: QAM demod. I comp</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM_Q_demod.png"><figure>
          <img src="/img/QAM/QAM_Q_demod.png" alt="QAM Ëß£Ë∞ÉÂêéÁöÑ Q ÂàÜÈáè‰ø°Âè∑" title="Âõæ11: QAM demod. Q comp"/>
          <figcaption>Âõæ11: QAM demod. Q comp</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<p>And the constellation diagram:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Reshape the demodulated signal into blocks of size `rep_symbol` and calculate the average for each block</span>
</span></span><span style="display:flex;"><span>A_I_demod <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>average(s_I_demod<span style="color:#f92672">.</span>reshape((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, rep_symbol)), <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>A_Q_demod <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>average(s_Q_demod<span style="color:#f92672">.</span>reshape((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, rep_symbol)), <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(s_I_demod<span style="color:#f92672">.</span>reshape((rep_symbol, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>print(A_I_demod<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># To draw constrllation</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Combined in-phase and quadrature components to form complex symbols</span>
</span></span><span style="display:flex;"><span>S_demod <span style="color:#f92672">=</span> A_I_demod <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>j <span style="color:#f92672">*</span> A_Q_demod
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the constellation</span>
</span></span><span style="display:flex;"><span>plot_constellation(S, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Transmitted&#34;</span>)
</span></span><span style="display:flex;"><span>plot_constellation(S_demod, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Received&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(<span style="color:#ae81ff">500</span>, <span style="color:#ae81ff">526</span>)
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">526</span>,)
</span></span></code></pre></div><p>
  <div class="post-img-view">
  <a data-fancybox="gallery" href="/img/QAM/QAM16_cons_a.png"><figure>
          <img src="/img/QAM/QAM16_cons_a.png" alt="QAM16 ÊòüÂ∫ßÂõæ(Ëß£Ë∞ÉÂêé)" title="Fig12: QAM16 constellation(demod.)"/>
          <figcaption>Fig12: QAM16 constellation(demod.)</figcaption>
          <style> 
            .post-img-view{text-align:center} 
          </style> 
      </figure></a>
  </div>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Round the demodulated signal&#39;s amplitudes to the nearest integers</span>
</span></span><span style="display:flex;"><span>A_I_demod <span style="color:#f92672">=</span> [int(round(x)) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> A_I_demod]
</span></span><span style="display:flex;"><span>A_Q_demod <span style="color:#f92672">=</span> [int(round(x)) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> A_Q_demod]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Map the rounded amplitudes to their corresponding binary strings in the normalized constellation</span>
</span></span><span style="display:flex;"><span>output_b <span style="color:#f92672">=</span> [norm_constallation[min(len(norm_constallation) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, int(x))] <span style="color:#f92672">+</span> norm_constallation[min(len(norm_constallation) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>, int(y))] <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(A_I_demod, A_Q_demod)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Concatenate all binary strings into a single bitstream</span>
</span></span><span style="display:flex;"><span>output_b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(output_b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Decode the bitstream using a Hamming decode function</span>
</span></span><span style="display:flex;"><span>output_b <span style="color:#f92672">=</span> list(decode(bitarray(output_b)))
</span></span><span style="display:flex;"><span>output_b_int_list <span style="color:#f92672">=</span> output_b
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert each binary value in the list to a string for easier manipulation</span>
</span></span><span style="display:flex;"><span>output_b <span style="color:#f92672">=</span> [str(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> output_b]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Group the binary strings into bytes (8 bits each) for interpretation</span>
</span></span><span style="display:flex;"><span>output_b <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(output_b[<span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>i : <span style="color:#ae81ff">8</span><span style="color:#f92672">*</span>i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(output_b) <span style="color:#f92672">//</span> <span style="color:#ae81ff">8</span>)]
</span></span><span style="display:flex;"><span>print(output_b[:<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert the grouped binary values back into the original string</span>
</span></span><span style="display:flex;"><span>output_string <span style="color:#f92672">=</span> bits2string(output_b)
</span></span><span style="display:flex;"><span>print(output_string)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;01000011&#39;</span>, <span style="color:#e6db74">&#39;01101111&#39;</span>, <span style="color:#e6db74">&#39;01101101&#39;</span>, <span style="color:#e6db74">&#39;01101101&#39;</span>, <span style="color:#e6db74">&#39;01110101&#39;</span>, <span style="color:#e6db74">&#39;01101110&#39;</span>, <span style="color:#e6db74">&#39;01101001&#39;</span>, <span style="color:#e6db74">&#39;01100011&#39;</span>, <span style="color:#e6db74">&#39;01100001&#39;</span>, <span style="color:#e6db74">&#39;01110100&#39;</span>]
</span></span><span style="display:flex;"><span>Communications Systems Communication Channel Simulation <span style="color:#f92672">and</span> Report<span style="color:#f92672">.</span> In this project, you will complete a simulation of a wireless communication system<span style="color:#f92672">.</span> This builds on the tasks <span style="color:#f92672">in</span> Lab <span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> the lectures cover all the background theory <span style="color:#66d9ef">for</span> each part of the task<span style="color:#f92672">.</span>
</span></span></code></pre></div><h2 id="bit-error-rate-ber">
  Bit Error Rate (BER)
  <a class="anchor" href="#bit-error-rate-ber">#</a>
</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(output_b_int_list[:<span style="color:#ae81ff">24</span>])
</span></span><span style="display:flex;"><span>print(input_b_int_list[:<span style="color:#ae81ff">24</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize the Bit Error Rate (BER) counter</span>
</span></span><span style="display:flex;"><span>BER <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize a list to store the indices of errors</span>
</span></span><span style="display:flex;"><span>error_list <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Iterate through pairs of input and output bits (or values) for comparison</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, (input, output) <span style="color:#f92672">in</span> enumerate(zip(input_b_int_list, output_b_int_list)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> input <span style="color:#f92672">!=</span> output: 
</span></span><span style="display:flex;"><span>        BER <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        error_list <span style="color:#f92672">+=</span> [i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Calculate the BER by dividing the total errors by the length of the output</span>
</span></span><span style="display:flex;"><span>BER <span style="color:#f92672">/=</span> len(output_b_int_list)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;BER is </span><span style="color:#e6db74">{</span>BER<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;find error at </span><span style="color:#e6db74">{</span>error_list<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>BER <span style="color:#f92672">is</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>find error at []
</span></span></code></pre></div><p>Perfect!</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>



<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#libraries">Libraries</a></li>
    <li><a href="#converting-between-string-and-binary">Converting Between String and Binary</a></li>
    <li><a href="#awgn-noise">AWGN Noise</a></li>
    <li><a href="#qam-modulation">QAM Modulation</a>
      <ul>
        <li><a href="#qam-theory">QAM Theory</a></li>
        <li><a href="#qam-code-implementation">QAM Code Implementation</a></li>
        <li><a href="#qam-constellation-diagram">QAM Constellation Diagram</a></li>
      </ul>
    </li>
    <li><a href="#path-loss-simulation-hata-model">Path Loss Simulation: Hata Model</a></li>
    <li><a href="#qam-demodulation">QAM Demodulation</a></li>
    <li><a href="#bit-error-rate-ber">Bit Error Rate (BER)</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












